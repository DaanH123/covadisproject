<PageTitle>Home</PageTitle>

@if (Reservations == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="overflow-x-auto mx-[2.5%]">
        @if (AuthState?.User?.Roles != null)
        {
            @foreach (var role in AuthState.User.Roles)
            {
                @if (role == "Administrator")
                {
                    <p class="my-4 font-bold">All reservations made by personal</p>
                }
                else
                {
                    <p class="my-4 font-bold">All reservations made by you @AuthState.User.Name</p>
                }
            }
        }
        <table class="w-[95%] bg-white border border-gray-200">
            <thead class="bg-gray-100">
                <tr>
                    <th class="border px-4 py-2 text-left">Id</th>
                    <th class="border px-4 py-2 text-left">Vehicle</th>
                    <th class="border px-4 py-2 text-left">From</th>
                    <th class="border px-4 py-2 text-left">Until</th>
                    <th class="border px-4 py-2 text-left">By</th>
                    @if (AuthState?.User?.Roles != null)
                    {
                        @foreach (var role in AuthState.User.Roles)
                        {
                            @if (role == "Administrator")
                            {
                                <th class="border px-4 py-2 text-left">Actions</th>
                            }
                        }
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (var reservation in Reservations)
                {
                    <tr class="even:bg-gray-50 odd:bg-white">
                        <td class="border px-4 py-2">@reservation.Id</td>
                        <td class="border px-4 py-2">@reservation.Vehicle.Brand @reservation.Vehicle.Model</td>
                        <td class="border px-4 py-2">@reservation.From.ToString("dd-MM-yyyy HH:mm")</td>
                        <td class="border px-4 py-2">@reservation.Until.ToString("dd-MM-yyyy HH:mm")</td>
                        <td class="border px-4 py-2">@reservation.User.Name</td>
                        @if (AuthState?.User?.Roles != null)
                        {
                            @foreach (var role in AuthState.User.Roles)
                            {
                                @if (role == "Administrator")
                                {
                                    <button @onclick="() => EditReservation(reservation.Id)" class=" btn my-1 mx-2 bg-yellow-500 text-white py-2 px-4 rounded">Edit</button>
                                    <button @onclick="() => DeleteReservation(reservation.Id)" class="btn my-1 mx-2 bg-red-500 text-white py-2 px-4 rounded">Delete</button>
                                }
                            }
                        }
                    </tr>
                }
            </tbody>
        </table>

        <button @onclick="GotoReservation" class="btn my-5 bg-blue-500 text-white ml-auto py-2 px-4 rounded">
            Add reservation
        </button>
    </div>
}
